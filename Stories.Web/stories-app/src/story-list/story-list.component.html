<h1 class="page-title">Histórias</h1>
<div class="user-selection">
  <mat-form-field appearance="fill">
    <mat-label>Selecione um usuário</mat-label>
    <mat-select [(ngModel)]="selectedUserId" name="selectedUser">
      <mat-option *ngFor="let user of users" [value]="user.id">
        {{ user.name }}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <button mat-raised-button color="primary" class="add-user-button" (click)="goToUsers()">Adicionar Usuário</button>
</div>

<div class="filter-section">
  <mat-form-field appearance="fill">
    <mat-label>Buscar Histórias</mat-label>
    <input matInput [(ngModel)]="searchText" (ngModelChange)="searchStories()" placeholder="ID, título, descrição ou departamento">
  </mat-form-field>
  <!-- <button mat-raised-button color="primary" (click)="searchStories()">Buscar</button> -->
</div>


<div class="story-list">
  <mat-card *ngFor="let story of filteredStories" class="story-card">
    <mat-card-header>
      <div class="vote-sum">{{ (story.positiveVotesCount ?? 0) - (story.negativeVotesCount ?? 0) }}</div>
      <mat-card-title>ID: {{ story.id }} - {{ story.title }}</mat-card-title> <!-- Exibe o ID aqui -->
      <mat-card-subtitle>{{ story.department }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <p>{{ story.description }}</p>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button class="vote-positive" (click)="vote(story.id!, true)">
        Votos Positivos: {{ story.positiveVotesCount }}
      </button>
      <button mat-button class="vote-negative" (click)="vote(story.id!, false)">
        Votos Negativos: {{ story.negativeVotesCount }}
      </button>
    </mat-card-actions>
  </mat-card>
</div>



<!-- Aviso de voto bem-sucedido -->
<div *ngIf="showVoteSuccess" class="vote-success">
  Voto realizado com sucesso!
</div>

<!-- Button to add a new story -->
<div class="add-story-button">
  <button mat-fab color="primary" (click)="goToAddStory()">+</button>
</div>
